# ML System Design - Классификация новостных статей по категориям

## План работы

### 0. Выбор кейса
**Доменная область:** текстовые данные  
**Бизнес-цель:** многоклассовая классификация с похожими классами  
**Задача:** автоматическая классификация новостных статей по категориям (например, Бизнес, Технологии, Спорт, Развлечения, Политика)

### 1. Сбор данных
- **Основные датасеты для рассмотрения:**
  - AG News (4 класса: World, Sports, Business, Sci/Tech)
  - BBC News (5 классов: Business, Entertainment, Politics, Sport, Tech)
  - 20 Newsgroups (20 различных категорий, можно сгруппировать)
  
- **Проверка лицензий:**
  - Проверить возможность использования в обучающих целях
  - Убедиться в отсутствии ограничений для академического использования
  
- **Weak Supervision:**
  - Использовать нелабелированные новостные статьи из других источников
  - Применить zero-shot классификацию через LLM или предобученные модели
  - Создать простые правила на основе ключевых слов для разметки дополнительных данных
  - Опционально: кросс-датасетное обогащение (использовать метки из одного датасета для другого)

### 2. Выбор метрик и разделение данных
- **Метрики:**
  - Основная: Macro F1-score (учитывает все классы равнозначно)
  - Дополнительные: Accuracy, Weighted F1, Confusion Matrix (для анализа ошибок между похожими классами)
  
- **Разделение датасета:**
  - Стратифицированное разделение для сохранения распределения классов
  - Проверка временных эффектов (если есть временные метки)
  - Пропорция: 70% обучающая, 15% валидационная, 15% тестовая

### 3. Подготовка данных
- **Очистка данных:**
  - Удаление дубликатов и проверка на near-duplicates
  - Обработка пропусков (если имеются)
  - Проверка на аномально короткие/длинные тексты
  
- **Предобработка текста:**
  - Приведение к нижнему регистру
  - Удаление/замена HTML-тегов, спецсимволов
  - Токенизация с учетом особенностей трансформеров
  - Анализ распределения длин текстов и выбор стратегии обрезания/дополнения
  
- **Аугментации:**
  - Синонимическая замена слов
  - Back-translation (перевод на другой язык и обратно)
  - Удаление случайных слов или фраз
  - Добавление шума (опечатки, перестановки)
  
- **Проверка на утечку:**
  - Поиск пересечений между train и test
  - Анализ источников данных на возможные утечки
  - Проверка временных границ (если применимо)

### 4. Бейзлайн
- **Простые модели для бейзлайна:**
  - TF-IDF + LogisticRegression (многоклассовая)
  - TF-IDF + SVM с линейным ядром
  - Fasttext с предобученными векторами
  
- **Оценка и анализ бейзлайна:**
  - Замер метрик на валидационной выборке
  - Анализ ошибок (особое внимание к похожим классам)
  - Создание confusion matrix для визуализации проблемных зон

### 5. Обучение первой DL модели
- **Выбор архитектуры:**
  - Легкий трансформер: DistilBERT, MobileBERT или TinyBERT
  - Стратегии для экономии ресурсов:
    - Замораживание embedding слоев
    - Постепенная разморозка слоев (progressive unfreezing)
    - Низкоранговая адаптация (LoRA)
  
- **Трекинг экспериментов:**
  - Настройка Weights & Biases (W&B) или MLflow
  - Отслеживание:
    - Loss на train/val
    - Метрики (F1-macro, accuracy) на train/val
    - Confusion matrix
    - Примеры ошибок классификации
    - Время обучения и использование памяти

### 6. Дальнейшие шаги (опционально)
- Гиперпараметрическая оптимизация (learning rate, batch size, длина последовательности)
- Ансамблирование с бейзлайн-методами
- Анализ ошибок и целевая доработка для проблемных классов
- Интерпретация модели (SHAP, LIME, attention weights)

## Текущий прогресс
*(Здесь будет обновляться статус выполнения каждого этапа)*

### Выбор кейса: ✅
- Выбрана задача многоклассовой классификации новостных текстов

### Сбор данных: ⏳
... 